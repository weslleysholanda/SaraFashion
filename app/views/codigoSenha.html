<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Resetar Senha</title>
  <link rel="stylesheet" href="../../public/vendors/css/reset.css">
  <link rel="stylesheet" href="../../public/assets/css/style.css">
</head>

<body>
  <section class="secao-recuperar">
    <div class="site">
      <div class="caixa-recuperar">
        <div class="area-logo">
          <img src="../../public/assets/img/logoDark.svg" alt="Logo">
        </div>

        <div class="title">
          <h1>Definir uma nova senha</h1>
        </div>

        <div class="subtitle">
          <p>Deve ter pelo menos 8 caracteres.</p>
        </div>

        <form method="" class="form-recuperar">
          <div class="form-control">
            <div class="campo-input">
              <svg xmlns="http://www.w3.org/2000/svg" width="15" height="20" viewBox="0 0 15 20">
                <path id="Caminho_8"
                  d="M68.079,7.826V5.217a5.641,5.641,0,0,0-11.25,0V7.826a1.811,1.811,0,0,0-1.875,1.739v8.7A1.811,1.811,0,0,0,56.829,20h11.25a1.811,1.811,0,0,0,1.875-1.739v-8.7A1.811,1.811,0,0,0,68.079,7.826ZM58.7,5.217a3.761,3.761,0,0,1,7.5,0V7.826H58.7Zm9.375,13.043H56.829v-8.7h11.25Zm-6.563-3.719v1.111a.94.94,0,0,0,1.875,0V14.541a1.716,1.716,0,0,0,.938-1.5,1.88,1.88,0,0,0-3.75,0A1.715,1.715,0,0,0,61.517,14.541Z"
                  transform="translate(-54.954)" fill="#888" />
              </svg>
              <input type="password" placeholder="Nova Senha: " id="senha" />
            </div>

            <div class="container_password">
              <div class="forca-senha">
                <span></span><span></span><span></span><span></span>
              </div>

              <div class="erro-senha" id="erro-senha"></div>
            </div>
          </div>

          <div class="campo-input">
            <svg xmlns="http://www.w3.org/2000/svg" width="15.703" height="14.257" viewBox="0 0 15.703 14.257">
              <path id="check"
                d="M17.347,5.218a1.32,1.32,0,0,1,2.008.017,1.819,1.819,0,0,1,.053,2.291L11.723,18.493a1.372,1.372,0,0,1-1.032.527,1.357,1.357,0,0,1-1.048-.483l-5.1-5.816a1.8,1.8,0,0,1-.415-1.614A1.56,1.56,0,0,1,5.173,9.918a1.334,1.334,0,0,1,1.414.473l4.034,4.6,6.69-9.726Z"
                transform="translate(-4.085 -4.763)" fill="#888" />
            </svg>
            <input type="password" placeholder="Confirmar senha" id="senha2" />
            <div class="erro-senha" id="erro-confirmacao"></div>
          </div>
          <button type="submit" class="btn-control" id="btn-submit" disabled>Confirmar</button>
        </form>
      </div>
    </div>
  </section>

  <script>
    const senhaInput = document.getElementById('senha');
    const senha2Input = document.getElementById('senha2');
    const forcaSpans = document.querySelectorAll('.forca-senha span');
    const erroSenha = document.getElementById('erro-senha');
    const erroConfirmacao = document.getElementById('erro-confirmacao');
    const btnSubmit = document.getElementById('btn-submit');

    function verificarForca(senha) {
      let forca = 0;
      if (senha.length >= 8) forca++;
      if (/[A-Z]/.test(senha)) forca++;
      if (/[0-9]/.test(senha)) forca++;
      if (/[\W_]/.test(senha)) forca++;
      return forca;
    }

    function atualizarIndicadores(forca) {
      let mensagem = '';
      let corMensagem = ''; // nova variável para a cor da mensagem

      forcaSpans.forEach((span, index) => {
        if (index < forca) {
          if (forca <= 1) {
            span.style.backgroundColor = '#ff0000';
            mensagem = 'Senha muito fraca. Use mais caracteres.';
            corMensagem = '#ff0000';
          } else if (forca <= 3) {
            span.style.backgroundColor = '#ffa500';
            mensagem = 'Senha fraca. Use letras maiúsculas, números e símbolos.';
            corMensagem = '#ffa500';
          } else {
            span.style.backgroundColor = '#008000';
            mensagem = 'Boa senha!';
            corMensagem = '#008000';
          }
        } else {
          span.style.backgroundColor = '#ccc';
        }
      });

      // Só exibe a mensagem se houver algo digitado
      if (senhaInput.value) {
        erroSenha.textContent = mensagem;
        erroSenha.style.color = corMensagem; // <-- aqui você define a cor da mensagem
      } else {
        erroSenha.textContent = '';
      }
    }


    function validar() {
      const senha = senhaInput.value;
      const confirmacao = senha2Input.value;
      const forca = verificarForca(senha);
      atualizarIndicadores(forca);

      // Só limpa a mensagem se o campo estiver vazio
      if (!senha) {
        erroSenha.textContent = '';
      }

      // Validação da confirmação
      if (!confirmacao) {
        erroConfirmacao.textContent = '';
      } else if (senha !== confirmacao) {
        erroConfirmacao.textContent = 'As senhas não coincidem.';
      } else {
        erroConfirmacao.textContent = '';
      }

      btnSubmit.disabled = !(forca >= 3 && senha === confirmacao);
    }

    senhaInput.addEventListener('input', validar);
    senha2Input.addEventListener('input', validar);
  </script>

</body>

</html>